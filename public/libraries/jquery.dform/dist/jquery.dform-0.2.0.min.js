(function(a){var l={},h={},d=a.each,c=function(b){var e=function(g,m,k){if(typeof g==="object")a.each(g,function(n,o){e(n,o,k)});else if(k===undefined||k===true){b[g]||(b[g]=[]);b[g].push(m)}};return e},f=a.isArray,i=function(b,e,g){a.dform.hasSubscription(b)&&this.each(function(){var m=a(this);d(l[b],function(k,n){n.call(m,e,g)})});return this},j=function(b){var e=b.type,g=this;this.dform("run","[pre]",b,e);d(b,function(m,k){g.dform("run",m,k,e)});this.dform("run","[post]",b,e);return this};a.extend(a,
{keyset:function(b){return a.map(b,function(e,g){return g})},withKeys:function(b,e){var g={};d(e,function(m,k){if(b[k])g[k]=b[k]});return g},withoutKeys:function(b,e){var g={};d(b,function(m,k){~a.inArray(m,e)||(g[m]=k)});return g},dform:{options:{prefix:"ui-dform-"},defaultType:function(b){return a("<"+b.type+">").dform("attr",b)},types:function(b){return b?h[b]:b},addType:c(h),subscribers:function(b){return b?l[b]:l},subscribe:c(l),hasSubscription:function(b){return l[b]?true:false},createElement:function(b){if(!b.type)throw"No element type given! Must always exist.";
var e=b.type,g=null,m=a.withoutKeys(b,["type"]);if(h[e])d(h[e],function(k,n){g=n.call(g,m)});else g=a.dform.defaultType(b);return a(g)},methods:{run:function(b,e,g){if(typeof b!=="string")return j.call(this,b);return i.call(this,b,e,g)},append:function(b,e){if(e&&a.dform.converters&&a.isFunction(a.dform.converters[e]))b=a.dform.converters[e](b);e=a.dform.createElement(b);this.append(e);e.dform("run",b)},attr:function(b,e){var g=a.keyset(l);f(e)&&a.merge(g,e);this.attr(a.withoutKeys(b,g))},ajax:function(b,
e,g){g={error:g,url:b};var m=this;typeof b!=="string"&&a.extend(g,b);g.success=function(k){m.dform(k);e(k)};a.ajax(g)},init:function(b,e){b=b.type?b:a.extend({type:"form"},b);if(e&&a.dform.converters&&a.isFunction(a.dform.converters[e]))b=a.dform.converters[e](b);if(this.is(b.type)){this.dform("attr",b);this.dform("run",b)}else this.dform("append",b)}}}});a.fn.dform=function(b){var e=a(this);a.dform.methods[b]?a.dform.methods[b].apply(e,Array.prototype.slice.call(arguments,1)):a.dform.methods.init.apply(e,
arguments);return this}})(jQuery);
(function(a){var l=a.each,h=function(c,f){return function(i){return a(c).dform("attr",i,f)}},d=function(c){var f=this;if(a.isPlainObject(c))f.dform("append",c);else a.isArray(c)?l(c,function(i,j){f.dform("append",j)}):f.html(c)};a.dform.addType({container:h("<div>"),text:h('<input type="text" />'),password:h('<input type="password" />'),submit:h('<input type="submit" />'),reset:h('<input type="reset" />'),hidden:h('<input type="hidden" />'),radio:h('<input type="radio" />'),checkbox:h('<input type="checkbox" />'),
file:h('<input type="file" />'),number:h('<input type="number" />'),url:h('<input type="url" />'),tel:h('<input type="tel" />'),email:h('<input type="email" />'),checkboxes:h("<div>",["name"]),radiobuttons:h("<div>",["name"])});a.dform.subscribe({"class":function(c){this.addClass(c)},html:d,elements:d,value:function(c){this.val(c)},css:function(c){this.css(c)},options:function(c,f){var i=this;if(f==="select"||f==="optgroup")l(c,function(j,b){j={type:"option",value:j};if(typeof b==="string")j.html=
b;if(typeof b==="object")j=a.extend(j,b);i.dform("append",j)});else if(f==="checkboxes"||f==="radiobuttons")l(c,function(j,b){var e=f==="radiobuttons"?{type:"radio"}:{type:"checkbox"};if(typeof b==="string")e.caption=b;else a.extend(e,b);e.value=j;i.dform("append",e)})},caption:function(c,f){var i={};if(typeof c==="string")i.html=c;else a.extend(i,c);if(f=="fieldset"){i.type="legend";this.dform("append",i)}else{i.type="label";if(this.attr("id"))i["for"]=this.attr("id");c=a(a.dform.createElement(i));
f==="checkbox"||f==="radio"?this.parent().append(a(c)):c.insertBefore(this);c.dform("run",i)}},type:function(c,f){a.dform.options.prefix&&this.addClass(a.dform.options.prefix+f)},url:function(){},"[post]":function(c,f){if(f==="checkboxes"||f==="radiobuttons")this.children("[type="+(f==="checkboxes"?"checkbox":"radio")+"]").each(function(){a(this).attr("name",c.name)})}})})(jQuery);
(function(a){function l(d){if(a.isFunction(d.split)){d=d.split(".");if(d.length>1){var c=d.shift();if(c=jQuery.global.localize(c))return a.getValueAt(c,d)}}return false}var h=function(d,c){return a.withKeys(c,a.keyset(a.ui[d].prototype.options))};a.dform.addType("progressbar",function(d){return a("<div>").dform("attr",d).progressbar(h("progressbar",d))},a.isFunction(a.fn.progressbar));a.dform.addType("slider",function(d){return a("<div>").dform("attr",d).slider(h("slider",d))},a.isFunction(a.fn.slider));
a.dform.addType("accordion",function(d){return a("<div>").dform("attr",d)},a.isFunction(a.fn.accordion));a.dform.addType("tabs",function(d){return a("<div>").dform("attr",d)},a.isFunction(a.fn.tabs));a.dform.subscribe("entries",function(d,c){if(c=="accordion"){var f=this;a.each(d,function(i,j){i=a.extend({type:"div"},j);a(f).formElement(i);if(j.caption){j=a(f).children("div:last").prev();j.replaceWith('<h3><a href="#">'+j.html()+"</a></h3>")}})}},a.isFunction(a.fn.accordion));a.dform.subscribe("entries",
function(d,c){if(c=="tabs"){var f=this;this.append("<ul>");var i=a(f).children("ul:first");a.each(d,function(j,b){j=b.id?b.id:j;a.extend(b,{type:"container",id:j});a(f).dform("append",b);b=a(f).children("div:last").prev();a(b).wrapInner(a("<a>").attr("href","#"+j));a(i).append(a("<li>").wrapInner(b))})}},a.isFunction(a.fn.tabs));a.dform.subscribe("dialog",function(d){this.dialog(d)},a.isFunction(a.fn.dialog));a.dform.subscribe("resizable",function(d){this.resizable(d)},a.isFunction(a.fn.resizable));
a.dform.subscribe("datepicker",function(d,c){c=="text"&&this.datepicker(d)},a.isFunction(a.fn.datepicker));a.dform.subscribe("autocomplete",function(d,c){c=="text"&&this.autocomplete(d)},a.isFunction(a.fn.autocomplete));a.dform.subscribe("[post]",function(d,c){if(this.parents("form").hasClass("ui-widget")){if((c==="button"||c==="submit")&&a.isFunction(a.fn.button))this.button();~a.inArray(c,["text","textarea","password","fieldset"])&&this.addClass("ui-widget-content ui-corner-all")}if(c==="accordion"||
c==="tabs")this[c](h(c,d))});a.dform.subscribe("[pre]",function(d,c){if(c=="form"){c={};if(this.hasClass("ui-widget"))c={highlight:function(f){a(f).addClass("ui-state-highlight")},unhighlight:function(f){a(f).removeClass("ui-state-highlight")}};typeof d.validate=="object"&&a.extend(c,d.validate);this.validate(c)}},a.isFunction(a.fn.validate));a.dform.subscribe("validate",function(d,c){c!="form"&&this.rules("add",d)},a.isFunction(a.fn.validate));a.dform.subscribe("ajax",function(d,c){c==="form"&&this.ajaxForm(d)},
a.isFunction(a.fn.ajaxForm));a.dform.subscribe(("html",function(d){if(typeof d==="string")(d=l(d))&&a(this).html(d)},a.global&&a.isFunction(a.global.localize)));if(a.global)a.getValueAt=function(d,c){c=isArray(c)?c:c.split(".");d=d;for(var f=0;f<c.length;f++){var i=c[f];if(!d[i])return false;d=d[i]}return d};a.dform.subscribe("options",function(d,c){if(c==="select"&&typeof d==="string"){a(this).html("");(d=l(d))&&a(this).dform("run","options",d,c)}},a.global)})(jQuery);
